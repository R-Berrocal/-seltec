import{v as I,w as h,y as S,n as E,r as p,d as j,t as m,p as V,Q as q,a as C,j as c,L as N,I as w,c as G,o as M}from"./index-00a53ffa.js";import{S as k}from"./select-1f413d34.js";import{a as O,L as y}from"./location-b1a7bb59.js";import{Y as Q}from"./validations-c17077ba.js";import{u as Y}from"./group-59a138a2.js";import"./useQuery-400e87ec.js";const $=I().shape({name:h().required("El nombre es requerido!"),groupId:Q.required("requerido")}),A={name:""};function B(){const o=S(),l=E(),{location:e,isLoading:g}=O(),f=p.useMemo(()=>{var r,s,u;return{name:(e==null?void 0:e.name)||"",groupId:{id:((r=e==null?void 0:e.group)==null?void 0:r.id)||"",value:((s=e==null?void 0:e.group)==null?void 0:s.id)||"",label:((u=e==null?void 0:e.group)==null?void 0:u.name)||""}}},[e]),t=j(),n=p.useCallback(async r=>{try{await y.editLocation(o.id||"",{...r,groupId:r.groupId.id}),t("/locations"),m("Locacion actualizada exitosamente",null)}catch(s){m(`opps!! algo no va bien ${s.response.data.message||""}`,"error"),console.error(s)}},[o,t]),d=p.useCallback(async r=>{try{const s=await y.createLocation({...r,groupId:r.groupId.id});return m("Locacion creada exitosamente",null),t("/locations"),s}catch(s){m(`opps!! algo no va bien ${s.response.data.message||""}`,"error"),console.error(s)}},[t]),{mutateAsync:i,isLoading:b}=V(o.id?n:d,{onSuccess:()=>{l.invalidateQueries([q.LOCATION])}});return{isLoading:g||b,submit:i,formValues:{defaultValues:o.id?f:A},status:o.id?"Editar locacion":"Crear locacion",isEditing:!!o.id}}const P=()=>{var s,u,L,x;const{submit:o,isLoading:l,formValues:{defaultValues:e},status:g}=B(),{handleSubmit:f,reset:t,formState:{errors:n},control:d}=C({mode:"all",defaultValues:e,resolver:M($)}),{groups:i,isLoading:b}=Y();p.useEffect(()=>{t(e)},[t,e]);const r=a=>{o(a)};return l||b?c.jsx(N,{}):c.jsxs("form",{onSubmit:f(r),className:"bg-white dark:bg-black mt-5 flex flex-col space-y-4",children:[c.jsx(w,{control:d,name:"name",label:"Nombre",errorMessage:((s=n.name)==null?void 0:s.message)||"",error:!!n.name}),c.jsx(k,{control:d,name:"groupId",options:((u=i==null?void 0:i.results)==null?void 0:u.map(a=>({id:a==null?void 0:a.id,label:a==null?void 0:a.name,value:a==null?void 0:a.id})))||[],placeholder:"Bloque",errorMessage:((x=(L=n.groupId)==null?void 0:L.label)==null?void 0:x.message)||""}),c.jsx(G.Button,{type:"submit",className:"mt-10",children:g})]})};export{P as default};
