import{t as E,v as f,x as M,n as N,r as c,d as y,q as u,p as L,Q as V,a as q,j as a,L as D,I as i,b as $,o as k}from"./index-a3a25342.js";import{b as Q,C as v}from"./company-a6f4b75b.js";import"./useQuery-28d0c69b.js";const I=E().shape({name:f().required("El nombre es requerido!").min(5,"Debe tener mas de 5 caracteres"),nit:f().max(9,"Debe ser maximo 9 numeros").min(9,"Debe ser minimo 9 numeros").matches(/^\d+$/,"Solo deben ser numeros").required("El nit es requerido!"),webSite:f().min(4,"Debe tener mas de 3 caracteres")}),Y={name:"",address:"",phone:"",email:"",webSite:"",nit:""};function A(){const t=M(),d=N(),{company:e,isLoading:b}=Q(),p=c.useMemo(()=>({name:(e==null?void 0:e.name)||"",email:(e==null?void 0:e.email)||"",address:(e==null?void 0:e.address)||"",phone:(e==null?void 0:e.phone)||"",webSite:(e==null?void 0:e.webSite)||"",nit:(e==null?void 0:e.nit)||""}),[e]),m=y(),s=c.useCallback(async o=>{try{await v.editcompany(t.id||"",o),u("Empresa actualizada exitosamente",null)}catch(r){u(`opps!! algo no va bien ${r.response.data.message||""}`,"error"),console.error(r)}},[t]),n=c.useCallback(async o=>{try{const r=await v.createCompany(o);return u("Empresa creada exitosamente",null),m("/companies"),r}catch(r){u(`opps!! algo no va bien ${r.response.data.message||""}`,"error"),console.error(r)}},[m]),{mutateAsync:g,isLoading:l}=L(t.id?s:n,{onSuccess:()=>{d.invalidateQueries([V.COMPANY])}});return{isLoading:b||l,submit:g,formValues:{defaultValues:t.id?p:Y},status:t.id?"Editar empresa":"Crear empresa",isEditing:!!t.id}}const R=()=>{var l,o,r,x,h,S,j,C;const{submit:t,isLoading:d,formValues:{defaultValues:e},status:b}=A(),{handleSubmit:p,reset:m,formState:{errors:s},control:n}=q({mode:"all",defaultValues:e,resolver:k(I)});c.useEffect(()=>{m(e)},[m,e]);const g=w=>{t(w)};return d?a.jsx(D,{}):a.jsxs("form",{onSubmit:p(g),className:"bg-white dark:bg-black mt-5 flex flex-col space-y-4",children:[a.jsxs("div",{className:"flex gap-4",children:[a.jsx(i,{control:n,name:"name",label:"Nombre",errorMessage:((l=s.name)==null?void 0:l.message)||"",error:!!s.name}),a.jsx(i,{control:n,name:"nit",label:"NIT",type:"number",errorMessage:((o=s.nit)==null?void 0:o.message)||"",error:!!s.nit})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx(i,{control:n,name:"email",label:"correo electronico",type:"email",errorMessage:((r=s.email)==null?void 0:r.message)||"",error:!!s.email}),a.jsx(i,{control:n,name:"address",label:"Dirección",errorMessage:((x=s.address)==null?void 0:x.message)||"",error:!!s.address})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx(i,{control:n,name:"phone",label:"Teléfono",type:"numbers",errorMessage:((h=s.phone)==null?void 0:h.message)||"",error:!!((S=s.phone)!=null&&S.message)}),a.jsx(i,{control:n,name:"webSite",label:"Sitio Web",errorMessage:((j=s.webSite)==null?void 0:j.message)||"",error:!!((C=s.webSite)!=null&&C.message)})]}),a.jsx($.Button,{type:"submit",className:"mt-10",children:b})]})};export{R as default};
