import{p as E,q as f,t as j,g as L,r as m,e as S,i as u,h as q,v as I,j as r,f as V,I as v,a as C,w as M}from"./index-2417ad1b.js";import{S as N}from"./select-a08db661.js";import{Q as $}from"./query-keys-96a731f2.js";import{b as k,O}from"./observation-e1a46e94.js";import{a as w}from"./employee-e5f804c0.js";const F=E().shape({initDate:f().required("La fecha de ingreso es requerida!"),endDate:f().required("La fecha de salida es requerida!"),employeeId:f().required("El empleado es requerido!")}),Q={observation:"",initDate:"",endDate:"",employeeId:""};function H(){const t=j(),p=L(),{observation:e,isLoading:b}=k(),d=m.useMemo(()=>({observation:(e==null?void 0:e.observation)||"",initDate:(e==null?void 0:e.initDate)||"",endDate:(e==null?void 0:e.endDate)||"",employeeId:(e==null?void 0:e.employee.id)||""}),[e]),n=S(),s=m.useCallback(async c=>{try{await O.editObservation(t.id||"",c),u("Observacion actualizado exitosamente",null)}catch(a){u(`opps!! algo no va bien ${a.response.data.message||""}`,"error"),console.error(a)}},[t]),o=m.useCallback(async c=>{try{const a=await O.createObservation(c);return u("Observacion creada exitosamente",null),n("/employee/observations"),a}catch(a){u(`opps!! algo no va bien ${a.response.data.message||""}`,"error"),console.error(a)}},[n]),{mutateAsync:g,isLoading:l}=q(t.id?s:o,{onSuccess:()=>{p.invalidateQueries([$.VEHICLE])}});return{isLoading:b||l,submit:g,formValues:{defaultValues:Object.keys(d).length<0?Q:d},status:t.id?"Editar Observacion":"Crear Observacion",isEditing:!!t.id}}const G=()=>{var a,x,h,y,D;const{submit:t,isLoading:p,formValues:{defaultValues:e},status:b}=H(),{handleSubmit:d,reset:n,formState:{errors:s},control:o}=I({mode:"all",defaultValues:e,resolver:M(F)});m.useEffect(()=>{n(e)},[n,e]);const g=i=>{t(i)},{employees:l,isLoading:c}=w();return p||c?r.jsx(V,{}):r.jsxs("form",{onSubmit:d(g),className:"bg-white dark:bg-black mt-5 flex flex-col space-y-4",children:[r.jsxs("div",{className:"flex gap-4",children:[r.jsx(v,{control:o,name:"observation",label:"Observacion",errorMessage:((a=s.observation)==null?void 0:a.message)||"",error:!!s.observation}),r.jsx(v,{control:o,name:"initDate",label:"Fecha de ingreso",errorMessage:((x=s.initDate)==null?void 0:x.message)||"",error:!!s.initDate})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx(v,{control:o,name:"endDate",label:"Fecha de salida",errorMessage:((h=s.endDate)==null?void 0:h.message)||"",error:!!s.endDate}),r.jsx(N,{children:!0,label:"Empleado",control:o,name:"employeeId",options:((y=l==null?void 0:l.results)==null?void 0:y.map(i=>({id:i.id,label:`${i.name} ${i.lastName}`,value:i.id})))||[],errorMessage:((D=s.employeeId)==null?void 0:D.message)||"",placeholder:"Empresa"})]}),r.jsx(C.Button,{type:"submit",className:"mt-10",children:b})]})};export{G as default};
